(this.webpackJsonptodolist=this.webpackJsonptodolist||[]).push([[0],{156:function(e,t,n){},170:function(e,t,n){"use strict";n.r(t);var r,a,o,c,i,s,l,d,u,j,b=n(0),p=n.n(b),O=n(58),h=n.n(O),x=n(11),m=(n(156),n(83)),g=n(19),f=n(238),v=n(233),w=n(239),y=n(240),C=n(130),S=n.n(C),k=n(1),I=Object(b.memo)((function(e){var t=e.setSearch,n=e.search;return Object(k.jsxs)(f.a,{variant:"standard",sx:{maxWidth:300,width:"100%"},children:[Object(k.jsx)(v.a,{htmlFor:"input-with-icon-adornment",children:"Search for todos"}),Object(k.jsx)(w.a,{id:"input-with-icon-adornment",value:n,onChange:function(e){return t(e.target.value)},startAdornment:Object(k.jsx)(y.a,{position:"start",children:Object(k.jsx)(S.a,{color:"primary",fontSize:"large"})})})]})})),$=n(231),P=n(22),T=n(226),A=(Object(T.a)(r||(r=Object(P.a)(["\n  {\n    getAllPosts {\n      id\n      title\n      body\n      completed\n      author {\n        id\n      }\n    }\n  }\n"]))),Object(T.a)(a||(a=Object(P.a)(["\n  query getAllUsers {\n    id\n    username\n    password\n    posts {\n      id\n      title\n      body\n    }\n  }\n"]))),Object(T.a)(o||(o=Object(P.a)(["\n  query getUserById {\n    id\n    username\n    password\n    posts {\n      id\n      title\n      body\n    }\n  }\n"]))),Object(T.a)(c||(c=Object(P.a)(["\n  {\n    getCurrentUser {\n      id\n      username\n    }\n  }\n"])))),U=Object(T.a)(i||(i=Object(P.a)(["\n  {\n    getUserPosts {\n      id\n      title\n      body\n      completed\n      author {\n        id\n      }\n    }\n  }\n"]))),W=n(27),B=n.n(W),D=n(60),q=n(40),R=n(236),z=n(229),L=Object(T.a)(s||(s=Object(P.a)(["\n  mutation LoginUser($username: String!, $password: String!) {\n    login(username: $username, password: $password)\n  }\n"]))),F=Object(T.a)(l||(l=Object(P.a)(["\n  mutation RegisterUser($username: String!, $password: String!) {\n    register(username: $username, password: $password)\n  }\n"]))),E=Object(T.a)(d||(d=Object(P.a)(["\n  mutation AddNewPost($title: String!, $body: String!, $completed: Boolean!) {\n    addPost(title: $title, body: $body, completed: $completed) {\n      id\n      title\n      body\n      author {\n        id\n      }\n    }\n  }\n"]))),M=Object(T.a)(u||(u=Object(P.a)(["\n  mutation RemovePost($postId: String!) {\n    deletePost(postId: $postId)\n  }\n"]))),N=Object(T.a)(j||(j=Object(P.a)(["\n  mutation UpdatePost($id: String!, $title: String, $body: String, $completed: Boolean) {\n    updatePost(id: $id, title: $title, body: $body, completed: $completed) {\n      title\n    }\n  }\n"]))),H=function(e){var t=e.id,n=e.completed,r=e.todos,a=e.setTodos,o=Object(R.a)(N),c=Object(x.a)(o,2),i=c[0],s=c[1].loading,l=Object(b.useCallback)(function(){var e=Object(q.a)(B.a.mark((function e(t,n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,i({variables:{id:t,completed:n}});case 3:a(r.map((function(e){return e.id!==t?e:Object(D.a)(Object(D.a)({},e),{},{completed:!e.completed})}))),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),alert(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t,n){return e.apply(this,arguments)}}(),[i,r,a]);return Object(k.jsx)(z.a,{size:"large",checked:n,disabled:s,onClick:function(){return l(t,!n)}})},J=n(243),G=n(241),Q=n(242),K=n(235),V=n(225),X=function(e){var t=e.children,n=e.open,r=e.onClose;return Object(k.jsx)(V.a,{open:n,onClose:r,children:Object(k.jsx)(Q.a,{sx:{width:"100%",maxWidth:500,position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",bgcolor:"background.paper",border:"2px solid",borderColor:"primary.main",borderRadius:"1rem",boxShadow:24,p:4},children:t})})},Y=n(133),Z=n.n(Y),_=function(e){var t=e.postId,n=e.todos,r=e.setTodos,a=Object(R.a)(M),o=Object(x.a)(a,2),c=o[0],i=o[1].loading,s=Object(b.useState)(!1),l=Object(x.a)(s,2),d=l[0],u=l[1],j=function(){var e=Object(q.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,c({variables:{postId:t}});case 3:u(!1),r(n.filter((function(e){return e.id!==t}))),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(0),alert("\u041e\u0448\u0438\u0431\u043a\u0430"),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(J.a,{"aria-label":"delete",onClick:function(){return u(!0)},children:Object(k.jsx)(Z.a,{color:"primary",fontSize:"large"})}),Object(k.jsxs)(X,{open:d,onClose:function(){return u(!1)},children:[Object(k.jsx)(G.a,{sx:{mb:"1em",textAlign:"center"},variant:"h5",component:"p",children:"\u0412\u044b \u0434\u0435\u0439\u0441\u0442\u0432\u0438\u0442\u0435\u043b\u044c\u043d\u043e \u0445\u043e\u0442\u0438\u0442\u0435 \u0443\u0434\u0430\u043b\u0438\u0442\u044c \u0434\u0430\u043d\u043d\u0443\u044e \u0437\u0430\u0434\u0430\u0447\u0443?"}),Object(k.jsxs)(Q.a,{sx:{display:"flex",justifyContent:"space-around"},children:[Object(k.jsx)(K.a,{disabled:i,variant:"contained",onClick:function(){return j(t)},children:"\u0423\u0434\u0430\u043b\u0438\u0442\u044c"}),Object(k.jsx)(K.a,{variant:"contained",onClick:function(){return u(!1)},children:"\u041e\u0442\u043c\u0435\u043d\u0438\u0442\u044c"})]})]})]})},ee=Object(b.memo)((function(e){var t=e.todos,n=e.setTodos,r=e.postId,a=e.title,o=e.desc,c=e.completed,i=e.onToggleCompleted;return Object(k.jsx)(Q.a,{sx:{border:"2px solid",borderColor:"primary.main",padding:"1rem",wordWrap:"break-word"},children:Object(k.jsxs)(Q.a,{sx:{display:"flex",alignItems:"center",gap:"10px"},children:[Object(k.jsx)(H,{id:r,onToggleCompleted:i,completed:c,todos:t,setTodos:n}),Object(k.jsxs)(Q.a,{sx:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column",gap:"1rem"},children:[Object(k.jsx)(G.a,{component:"p",variant:"h5",children:c?Object(k.jsx)("del",{children:a}):a}),Object(k.jsx)(G.a,{component:"p",variant:"h6",children:c?Object(k.jsx)("del",{children:o}):o})]}),Object(k.jsx)(_,{todos:t,setTodos:n,postId:r})]})})})),te=n(25),ne=n(232),re=n(230),ae=n(223),oe=Object(b.memo)((function(e){var t=e.addNew,n=e.loading,r=Object(b.useState)(""),a=Object(x.a)(r,2),o=a[0],c=a[1],i=Object(b.useState)(""),s=Object(x.a)(i,2),l=s[0],d=s[1],u=function(){var e=Object(q.a)(B.a.mark((function e(n){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return n.preventDefault(),e.next=3,t(o,l,!1);case 3:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}();return Object(k.jsxs)(Q.a,{sx:{display:"flex",flexDirection:"column",alignItems:"center",gap:"0.7rem"},component:"form",onSubmit:u,action:"",children:[Object(k.jsx)(G.a,{component:"p",variant:"h5",children:"Add new Todo"}),Object(k.jsx)(ae.a,{label:"Title",id:"todo-title",required:!0,value:o,onChange:function(e){return c(e.target.value)},sx:{maxWidth:400,width:"100%"},disabled:n}),Object(k.jsx)(ae.a,{id:"todo-description",onChange:function(e){return d(e.target.value)},required:!0,value:l,label:"Description",multiline:!0,maxRows:6,sx:{maxWidth:400,width:"100%"},disabled:n}),Object(k.jsx)(K.a,{disabled:n,variant:"contained",type:"submit",children:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c \u0437\u0430\u0434\u0430\u0447\u0443"})]})})),ce=function(e){var t=e.setTodos,n=e.todos,r=Object(b.useState)(!1),a=Object(x.a)(r,2),o=a[0],c=a[1],i=Object(b.useState)(!1),s=Object(x.a)(i,2),l=s[0],d=s[1],u=Object(R.a)(E,{onCompleted:function(e){var r=e.addPost;t([].concat(Object(te.a)(n),[r])),c(!1)}}),j=Object(x.a)(u,2),p=j[0],O=j[1].loading,h=Object(b.useCallback)(function(){var e=Object(q.a)(B.a.mark((function e(t,n,r){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,p({variables:{title:t,body:n,completed:r}});case 3:e.next=9;break;case 5:e.prev=5,e.t0=e.catch(0),d(!0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t,n,r){return e.apply(this,arguments)}}(),[p]);return Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(K.a,{variant:"contained",onClick:function(){return c(!0)},children:"\u0414\u043e\u0431\u0430\u0432\u0438\u0442\u044c \u043d\u043e\u0432\u0443\u044e \u0437\u0430\u0434\u0430\u0447\u0443"}),Object(k.jsx)(X,{open:o,onClose:function(){return c(!1)},children:Object(k.jsx)(oe,{addNew:h,loading:O})}),Object(k.jsx)(ne.a,{open:l,onClose:function(){return d(!1)},autoHideDuration:3e3,children:Object(k.jsx)(re.a,{onClose:function(){return d(!1)},sx:{width:"100%"},severity:"error",children:"Error!"})})]})},ie=Object(b.createContext)(null),se=function(){var e=Object(b.useContext)(ie).setIsAuth,t=Object(g.g)();return Object(k.jsx)(K.a,{variant:"outlined",onClick:function(){localStorage.removeItem("token"),t.push("/"),e(!1)},children:"LOGOUT"})},le=n(245),de=n(246),ue=n(221),je=function(){var e,t=Object(b.useState)(),n=Object(x.a)(t,2),r=n[0],a=n[1],o=Object(b.useState)(""),c=Object(x.a)(o,2),i=c[0],s=c[1],l=Object($.a)(U,{onCompleted:function(e){a(e.getUserPosts)}}).loading,d=Object($.a)(A),u=d.data,j=d.loading,p=Object(b.useCallback)((function(e){return s(e)}),[]);console.log(u,localStorage.getItem("token"));var O={display:"flex",justifyContent:"space-between",flexWrap:"wrap",gap:"1.3rem",marginBottom:"1rem"};return l||j?Object(k.jsx)(Q.a,{sx:{height:"50vh",display:"flex",justifyContent:"center",alignItems:"center"},children:Object(k.jsx)(le.a,{size:150})}):Object(k.jsxs)(de.a,{sx:{marginBlock:"2rem"},children:[Object(k.jsxs)(Q.a,{sx:O,children:[Object(k.jsx)(G.a,{sx:{width:300,display:"inline-block",overflow:"hidden",textOverflow:"ellipsis"},variant:"h5",component:"p",children:u.getCurrentUser.username}),Object(k.jsx)(se,{})]}),Object(k.jsxs)(Q.a,{sx:O,children:[Object(k.jsx)(ce,{setTodos:a,todos:r}),Object(k.jsx)(I,{search:i,setSearch:p})]}),Object(k.jsx)(G.a,{textAlign:"center",variant:"h4",component:"p",marginBottom:"1em",sx:{overflow:"auto"},children:i?"Search: ".concat(i):"My todos"}),Object(k.jsxs)(ue.a,{spacing:1,children:[0===(null===r||void 0===r?void 0:r.length)&&Object(k.jsx)(G.a,{variant:"h5",component:"p",textAlign:"center",children:"Todos not found."}),null===(e=null===r||void 0===r?void 0:r.filter((function(e){var t;return null===e||void 0===e||null===(t=e.title)||void 0===t?void 0:t.toUpperCase().includes(i.toUpperCase())})))||void 0===e?void 0:e.map((function(e){return Object(k.jsx)(ee,{todos:r,setTodos:a,postId:e.id,title:e.title,desc:e.body,completed:e.completed},e.id)}))]})]})},be=function(e){var t=e.children,n=e.type,r=void 0===n?"button":n,a=e.disabled;return Object(k.jsx)(K.a,{type:r,variant:"contained",sx:{maxWidth:200,width:"100%"},disabled:a,children:t})},pe=function(e){var t=e.children,n=e.onSubmit;return Object(k.jsx)(Q.a,{sx:{display:"flex",justifyContent:"center",alignItems:"center",maxWidth:"100%",height:"100%"},children:Object(k.jsx)(Q.a,{component:"form",onSubmit:n,action:"",sx:{maxWidth:600,width:"100%",minHeight:500,display:"flex",justifyContent:"center",alignItems:"center",flexDirection:"column",gap:"1.2rem",border:"1px solid rgba(0,0,0,0.3)",padding:"1rem"},children:t})})},Oe=function(e){return Object(k.jsx)(ae.a,Object(D.a)({variant:"outlined",sx:{maxWidth:300,width:"100%"},required:!0},e))},he=function(){var e=Object(b.useState)(""),t=Object(x.a)(e,2),n=t[0],r=t[1],a=Object(b.useState)(""),o=Object(x.a)(a,2),c=o[0],i=o[1],s=Object(R.a)(F),l=Object(x.a)(s,2),d=l[0],u=l[1].loading,j=Object(g.g)(),p=function(){var e=Object(q.a)(B.a.mark((function e(t){return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,d({variables:{username:n,password:c}});case 4:j.push("/"),e.next=11;break;case 7:e.prev=7,e.t0=e.catch(1),alert("\u041e\u0448\u0438\u0431\u043a\u0430"),console.log(e.t0);case 11:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(t){return e.apply(this,arguments)}}();return Object(k.jsxs)(pe,{onSubmit:p,children:[Object(k.jsx)("h2",{children:"Registration"}),Object(k.jsx)(Oe,{id:"login",label:"Login",value:n,onChange:function(e){return r(e.target.value)},disabled:u}),Object(k.jsx)(Oe,{id:"password",label:"Password",value:c,onChange:function(e){return i(e.target.value)},disabled:u,type:"password"}),Object(k.jsx)(be,{type:"submit",disabled:u,children:"Create account"})]})},xe=function(){var e=Object(R.a)(L),t=Object(x.a)(e,2),n=t[0],r=t[1].loading,a=Object(b.useState)(""),o=Object(x.a)(a,2),c=o[0],i=o[1],s=Object(b.useState)(""),l=Object(x.a)(s,2),d=l[0],u=l[1],j=Object(g.g)(),p=Object(b.useContext)(ie).setIsAuth;console.log(localStorage.getItem("token"));var O=function(){var e=Object(q.a)(B.a.mark((function e(t){var r,a;return B.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t.preventDefault(),e.prev=1,e.next=4,n({variables:{username:c,password:d}});case 4:r=e.sent,a=r.data,console.log("login data: ",a),localStorage.setItem("token",a.login),localStorage.getItem("token")&&p(!0),j.push("/home"),e.next=16;break;case 12:e.prev=12,e.t0=e.catch(1),alert("\u041e\u0448\u0438\u0431\u043a\u0430"),console.log(e.t0);case 16:case"end":return e.stop()}}),e,null,[[1,12]])})));return function(t){return e.apply(this,arguments)}}();return Object(k.jsxs)(pe,{onSubmit:O,children:[Object(k.jsx)("h2",{children:"Login"}),Object(k.jsx)(Oe,{id:"login",label:"Login",value:c,onChange:function(e){return i(e.target.value)},disabled:r}),Object(k.jsx)(Oe,{id:"password",label:"Password",value:d,onChange:function(e){return u(e.target.value)},disabled:r,type:"password"}),Object(k.jsx)(be,{type:"submit",disabled:r,children:"Confirm"}),Object(k.jsx)(be,{disabled:r,children:Object(k.jsx)(m.b,{to:"/registration",children:"Registration"})})]})},me=function(){return Object(k.jsx)(Q.a,{sx:{alignItems:"center",backgroundColor:"primary.main",padding:"1rem"},component:"header",children:Object(k.jsx)(G.a,{component:"p",variant:"h5",color:"whitesmoke",children:"Maybetomorrow"})})},ge=function(){var e=Object(b.useContext)(ie).isAuth;return Object(k.jsx)(m.a,{children:e?Object(k.jsxs)(k.Fragment,{children:[Object(k.jsx)(me,{}),Object(k.jsxs)(g.d,{children:[Object(k.jsx)(g.b,{exact:!0,path:"/home",children:Object(k.jsx)(je,{})}),Object(k.jsx)(g.a,{to:"/home"})]})]}):Object(k.jsxs)(g.d,{children:[Object(k.jsx)(g.b,{exact:!0,path:"/",children:Object(k.jsx)(xe,{})}),Object(k.jsx)(g.b,{path:"/registration",children:Object(k.jsx)(he,{})}),Object(k.jsx)(g.a,{to:"/"})]})})},fe=n(137),ve=n(224),we=n(227),ye=n(135),Ce=Object(fe.a)({uri:"".concat("https://maybetomorrow-server.herokuapp.com/graphql")}),Se=Object(ye.a)((function(e,t){var n=t.headers,r=localStorage.getItem("token");return console.log("Apollo Token: ",r),{headers:Object(D.a)(Object(D.a)({},n),{},{authorization:r?"Bearer ".concat(r):""})}})),ke=new ve.a({link:Se.concat(Ce),cache:new we.a,defaultOptions:{watchQuery:{fetchPolicy:"network-only",errorPolicy:"ignore"},query:{fetchPolicy:"network-only",errorPolicy:"all"}}}),Ie=n(222),$e=function(){var e=Object(b.useState)(!1),t=Object(x.a)(e,2),n=t[0],r=t[1];return Object(b.useEffect)((function(){localStorage.getItem("token")?r(!0):r(!1)}),[]),Object(k.jsx)(ie.Provider,{value:{isAuth:n,setIsAuth:r},children:Object(k.jsx)(Ie.a,{client:ke,children:Object(k.jsx)(ge,{})})})};h.a.render(Object(k.jsx)(p.a.StrictMode,{children:Object(k.jsx)($e,{})}),document.getElementById("root"))}},[[170,1,2]]]);
//# sourceMappingURL=main.de19462c.chunk.js.map